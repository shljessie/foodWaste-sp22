{% extends "base.html" %} {% block title %}Home{% endblock %} {% block content
%}

<head>
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.0.0/d3.min.js"></script>
</head>

<h1 align="center">Food Waste Data</h1>
<br />

<div id="my_dataviz">
  <div id="fw" style="display: hidden"></div>
  <div id="ms"></div>
  <div id="dp"></div>
  <div id="gom"></div>
</div>

<script>
  // from flask import jsonify;

  fetch("/user-data").then(() => {
    user_data = json.dumps(user);

    console.log(user_data);
  });

  function showVal() {}

  // var PouchDB = require("../database.db");
  // console.log(PouchDB);

  // Show Graph
  function showGraph() {
    console.log("clicked");
    document.getElementById("fw").style.display = "show";
  }

  // set the dimensions and margins of the graph
  var margin = { top: 20, right: 30, bottom: 40, left: 90 },
    width = 1060 - margin.left - margin.right,
    height = 500 - margin.top - margin.bottom;

  // append the svg object to the body of the page
  var svg = d3
    .select("#fw")
    .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append("g")
    .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

  // create data viz

  // import data

  // console.log(dataU);

  // Parse the Data
  d3.csv(
    "https://raw.githubusercontent.com/holtzy/data_to_viz/master/Example_dataset/7_OneCatOneNum_header.csv",
    function (data) {
      console.log(data);

      // Add X axis
      var x = d3.scaleLinear().domain([0, 3000]).range([0, width]);
      svg
        .append("g")
        .attr("transform", "translate(0," + height + ")")
        .call(d3.axisBottom(x))
        .selectAll("text")
        .attr("transform", "translate(-10,0)rotate(-45)")
        .style("text-anchor", "end");

      // create y axis
      var yAxis = [
        "Fruits",
        "Vegetables",
        "Milk",
        "Dairy",
        "Meat",
        "Poultry",
        "Seafood",
        "Takeout/Leftovers",
        "Misc",
      ];
      var y = d3.scale.ordinal().domain(yAxis).rangeRoundBands([20, height]);

      svg.append("g").call(d3.axisLeft(y));

      //Bars
      svg
        .selectAll("fw")
        .data(data)
        .enter()
        .append("rect")
        .attr("x", x(0))
        .attr("y", function (d) {
          return y(d.Country);
        })
        .attr("width", function (d) {
          return x(d.Value);
        })
        .attr("height", y.bandwidth())
        .attr("fill", "#69b3a2");
    }
  );
</script>

<br />
<div align="center">
  <table>
    <tr>
      <th>
        <form method="POST">
          <input
            type="hidden"
            name="food_waste_CLICK"
            id="food_waste_CLICK"
            value="food_waste_CLICK"
          />
          <input type="hidden" name="foodwCLICK" id="foodwCLICK" value="1" />
          <button type="submit" class="btn btn-secondary" onclick="">
            Total Food Wasted
          </button>
        </form>
      </th>
      <th>
        <form method="POST">
          <input
            type="hidden"
            name="money_spent_CLICK"
            id="money_spent_CLICK"
            value="money_spent_CLICK"
          />
          <input type="hidden" name="monwCLICK" id="monwCLICK" value="1" />
          <button type="submit" class="btn btn-secondary">
            Total Money Spent
          </button>
        </form>
      </th>
      <th>
        <form method="POST">
          <input
            type="hidden"
            name="daily_progress_CLICK"
            id="daily_progress_CLICK"
            value="daily_progress_CLICK"
          />
          <input type="hidden" name="progCLICK" id="progCLICK" value="1" />
          <button type="submit" class="btn btn-secondary">
            Daily Progress
          </button>
        </form>
      </th>
      <th>
        <form method="POST">
          <input
            type="hidden"
            name="green_o_meter_CLICK"
            id="green_o_meter_CLICK"
            value="green_o_meter_CLICK"
          />
          <input type="hidden" name="gomCLICK" id="gomCLICK" value="1" />
          <button type="submit" class="btn btn-secondary">Green-O-Meter</button>
        </form>
      </th>
    </tr>
  </table>
</div>
<br />

<!-- {% for day in user.foodWaste %}
  {{ day.fruit }}
  {% endfor %} -->
<ul class="list-group list-group-flush" id="notes">
  {% for day in user.foodWaste %}
  <li class="list-group-item">
    {{ day.date }}
    <button type="button" class="close" onClick="deleteNote({{ day.id }})">
      <span aria-hidden="true">&times;</span>
    </button>

    <script>
      function deleteNote(noteId) {
        fetch("/delete-note", {
          method: "POST",
          body: JSON.stringify({ noteId: noteId }),
        }).then((_res) => {
          window.location.href = "/";
        });
      }
      function showVal() {}
    </script>
  </li>
  {% endfor %}
</ul>

<script>
  function outputUpdate(vol, id) {
    document.querySelector("#" + id).value = vol;
  }
</script>

<br />

<form method="POST">
  <input
    type="hidden"
    name="food_waste_data"
    id="food_waste_data"
    value="food_waste_data"
  />
  <label for="fruit">Fruits</label>
  <input
    type="range"
    name="fruit"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="fruit"
    oninput="outputUpdate(value, 'fruit_val')"
  />
  <output for="fruit" id="fruit_val">0</output>
  &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
  <label for="veggies">Vegetables</label>
  <input
    type="range"
    name="veggies"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="veggies"
    oninput="outputUpdate(value, 'veggie_val')"
  />
  <output for="veggies" id="veggie_val">0</output>
  &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
  <label for="milk">Milk</label>
  <input
    type="range"
    name="milk"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="milk"
    oninput="outputUpdate(value, 'milk_val')"
  />
  <output for="milk" id="milk_val">0</output>

  <br />
  <label for="dairy">Dairy</label>
  <input
    type="range"
    name="dairy"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="dairy"
    oninput="outputUpdate(value, 'dairy_val')"
  />
  <output for="dairy" id="dairy_val">0</output>
  &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
  &nbsp &nbsp &nbsp &nbsp &nbsp
  <label for="meat">Meat</label>
  <input
    type="range"
    name="meat"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="meat"
    oninput="outputUpdate(value, 'meat_val')"
  />
  <output for="meat" id="meat_val">0</output>
  &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
  <label for="poultry">Poultry</label>
  <input
    type="range"
    name="poultry"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="poultry"
    oninput="outputUpdate(value, 'poultry_val')"
  />
  <output for="poultry" id="poultry_val">0</output>

  <br />
  <label for="fish_seafood">Seafood</label>
  <input
    type="range"
    name="fish_seafood"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="fish_seafood"
    oninput="outputUpdate(value, 'fish_seafood_val')"
  />
  <output for="fish_seafood" id="fish_seafood_val">0</output>
  &nbsp &nbsp &nbsp &nbsp &nbsp
  <label for="takeout">Takeout/Leftovers</label>
  <input
    type="range"
    name="takeout"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="takeout"
    oninput="outputUpdate(value, 'takeout_val')"
  />
  <output for="takeout" id="takeout_val">0</output>
  &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp &nbsp
  <label for="other">Misc.</label>
  <input
    type="range"
    name="other"
    min="0"
    max="100"
    value="0"
    class="myslider"
    id="other"
    oninput="outputUpdate(value, 'other_val')"
  />
  <output for="other" id="other_val">0</output>

  <br />
  <br />
  <div align="center">
    <button type="submit" class="btn btn-primary">Add Food</button>
  </div>
</form>
{% endblock %}

<!--  -->
